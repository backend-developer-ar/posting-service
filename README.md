# Тестовое задание: Сервис для постинга

С ТЗ можно ознакомиться [здесь](TASK.md)

## Требования
- Python 3.11
- PostgreSQL

## Запуск
· Для первоначального запуска сервиса, прежде всего, потребуется установить его зависимости. 
Сделать это можно
с помощью команды `pip install -r requirements.txt` в основной директории проекта.  

· После этого необходимо заполнить [файл конфигурации](config/config.py) сервиса, а именно:  
- Заполнить информацию о используемой БД в классе `Postgres`
- Заполнить параметры `HOST` и `PORT` в основном классе `Settings`. Сервис будет запускаться на указанном хосте. (По умолчанию localhost)

· Далее, необходимо применить миграции для указанной вами БД. Миграции применяются с помощью команды `alembic upgrade head`

Готово! Теперь можно запускать сервис с помощью команды `python main.py` в основной директории и пользоваться сервисом на указанном вами хосте!

Проверить кодстайл сервиса можно с помощью команды `pylint ./*`

## Использование
Для использования сервиса следует пользоваться интерактивной документацией Swagger UI, доступной по URL `/docs`.  
Описание API сервиса

### Аутентификация
В этом разделе находятся ручки, связанные с аутентификацией.

#### · Регистрация нового пользователя

| Метод | URL       | Нужна авторизация |
|-------|-----------|-------------------|
| POST  | /register | Нет               |

Пример тела запроса:
```
{
  "email": "user@example.com",
  "password": "password"
}
```
#### · Авторизация пользователя

| Метод | URL    | Нужна авторизация |
|-------|--------|-------------------|
| POST  | /login | Нет               |

Параметры:
```
username: "user@example.com",
password: "password"
```
В ответе на запрос будет содержаться access_token, необходимый для запросов с обязательной авторизацией.  
При использовании Swagger UI можно авторизоваться с помощью кнопки authorize, чтобы каждый раз не указывать токен.

#### · Выход с аккаунта

| Метод | URL     | Нужна авторизация |
|-------|---------|-------------------|
| POST  | /logout | Да                |

### Публикация
В этом разделе описаны все ручки, связанные с публикациями.

#### · Просмотр публикации

| Метод | URL             | Нужна авторизация |
|-------|-----------------|-------------------|
| GET   | /post/{post_id} | Нет               |

Пример ответа:
```
{
  "body": "Текст публикации",
  "created": "2024-02-08T17:53:06.048Z",
  "author_id": 1,
  "votes_amount": 12,
  "rating": 7
}
```

#### · Создание публикации

| Метод | URL   | Нужна авторизация |
|-------|-------|-------------------|
| POST  | /post | Да                |

Пример тела запроса

```
{
  "body": "Текст публикации"
}
```

#### · Получение публикаций
Получение N кол-ва публикаций, отсортированных по указанному признаку

| Метод | URL            | Нужна авторизация |
|-------|----------------|-------------------|
| GET   | /posts  | Нет               |

Параметры:
- sorting: Признак, по которому будут фильтроваться записи. возможные значения: `"latest", "best"`
- amount: Кол-во публикаций, которые нужно вывести. По умолчанию 10


### Оценка публикаций

#### · Апвоут публикации
Проставление положительной оценки публикации

| Метод | URL                    | Нужна авторизация |
|-------|------------------------|-------------------|
| POST  | /post/{post_id}/upvote | Да                |

#### · Даунвоут публикации
Проставление отрицательной оценки публикации

| Метод | URL                      | Нужна авторизация |
|-------|--------------------------|-------------------|
| POST  | /post/{post_id}/downvote | Да                |

#### · Отмена оценки публикации
Отмена проставленной оценки

| Метод | URL                         | Нужна авторизация |
|-------|-----------------------------|-------------------|
| POST  | /post/{post_id}/cancel-vote | Да                |
